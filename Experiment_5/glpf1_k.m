function modified=glpf1_k(source,k)

%7*7 gaussian kernel

n=[0.00000067	0.00002292	0.00019117	0.00038771	0.00019117	0.00002292	0.00000067;
0.00002292	0.00078633	0.00655965	0.01330373	0.00655965	0.00078633	0.00002292;
0.00019117	0.00655965	0.05472157	0.11098164	0.05472157	0.00655965	0.00019117;
0.00038771	0.01330373	0.11098164	0.22508352	0.11098164	0.01330373	0.00038771;
0.00019117	0.00655965	0.05472157	0.11098164	0.05472157	0.00655965	0.00019117;
0.00002292	0.00078633	0.00655965	0.01330373	0.00655965	0.00078633	0.00002292;
0.00000067	0.00002292	0.00019117	0.00038771	0.00019117	0.00002292	0.00000067];

for i=1:k
    
if i==1    
    modified=conv2(single(source),single(n));
end
if i>1
    modified=conv2(single(modified),single(n));
end

R=size(modified,1);
C=size(modified,2);

modified=modified(4:R-3,4:C-3);

R=size(source,1);
C=size(source,2);

modified(1,1:C)=source(1,1:C);
modified(R,1:C)=source(R,1:C);
modified(1:R,1)=source(1:R,1);
modified(1:R,C)=source(1:R,C);
end

%end